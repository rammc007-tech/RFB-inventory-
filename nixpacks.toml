# Nixpacks configuration for Railway
# Industry-standard Next.js + Prisma deployment

[phases.setup]
nixPkgs = ["nodejs-18_x"]

[phases.install]
cmds = ["npm ci --prefer-offline --no-audit || npm install --prefer-offline --no-audit"]

[phases.build]
cmds = [
  "npx prisma generate || echo 'Prisma generate warning (may need DATABASE_URL)'",
  "NODE_ENV=production NEXTAUTH_URL=${NEXTAUTH_URL:-http://localhost:3000} NEXTAUTH_SECRET=${NEXTAUTH_SECRET:-temp-secret} next build"
]
